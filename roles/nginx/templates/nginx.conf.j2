#{{ansible_managed}}

user www-data;
pid /var/run/nginx.pid;
ssl_engine dynamic;
worker_processes {{ansible_processor_count}};

events {
  multi_accept on;
  worker_connections {{nginx_max_connections}};
  use epoll;
}

http {
  sendfile on;

  tcp_nopush on;
  tcp_nodelay off;

  client_max_body_size {{nginx_max_body_size}};

  {% for setting, value in nginx_http_conf.iteritems() %}
  {{setting}} {{value}};
  {% endfor %}

  default_type application/octet-stream;

  include /etc/nginx/conf.d/*.conf;
  include /etc/nginx/sites-enabled/*;
}
